# Containerized Standalone TiDB Cluster

This is the containerized standalone TiDB cluster generated by TiUP.

## Requirements

- Docker
- MySQL Client (optional)

## Quick Start Usage

TiDB cluster starts with 1 PD instance, 1 TiDB instance, 1 TiKV instance, and 1 TiFlash instance.

### 1. Build

Build a Docker image with TiUP installer

```bash
docker image build -t standalone-tidb-cluster:latest .
```

### 2. Run

Run a Docker container continuously in foreground mode.

***It can be also run in background mode, but it takes longer to setup TiDB cluster after the container starts running.**

```bash
docker container run --rm \
    -p 4000:4000 \
    -p 2379:2379 \
    -p 9090:9090 \
    -p 3000:3000 \
    --name standalone-tidb-cluster standalone-tidb-cluster:latest
```

### 3. Connect to TiDB

- Use the TiUP client in the running container

    ```bash
    docker container exec -it standalone-tidb-cluster tiup client
    ```

- Use your MySQL client

    ```bash
    mysql --host 127.0.0.1 --port 4000 -u root
    ```

### 4. Access Dashboards of TiDB

- Access the [TiDB Dashboard](https://docs.pingcap.com/tidb/dev/dashboard-intro)

    URL: <http://127.0.0.1:2379/dashboard>

    username: root

    password: (empty)

- Access the Prometheus dashboard of TiDB

    URL: <http://127.0.0.1:9090>

- Access the Grafana dashboard of TiDB

    URL: <http://127.0.0.1:3000>

    username: admin

    password: admin

### 5. Shutdown

Stop and remove the Docker container

```bash
docker container stop standalone-tidb-cluster
```

## [Optional] Customized TiDB Cluster

The following commands customize the number of PD, TiDB, TiKV, and TiFlash instances in the specific version of TiDB cluster when building the Docker image.

***It depends on the disk size limit of your Docker whether the container of customized TiDB cluster can be run or not.**

### Customized Build Example

```bash
# 3 PD instances,
# 2 TiDB instances,
# 3 TiKV instances,
# and 2 TiFlash instances
# in the TiDB cluster version '7.0.0'
docker image build \
    --build-arg version=7.0.0 \
    --build-arg pd=3 \
    --build-arg tidb=2 \
    --build-arg tikv=3 \
    --build-arg tiflash=2 \
    -t standalone-tidb-cluster:latest .
```

## See Also

[Quick Start Guide for the TiDB Database Platform (PingCAP Docs)](https://docs.pingcap.com/tidb/dev/quick-start-with-tidb)
